---
title: "ğŸ”„ Factory Workflow Diagram"
subtitle: "Full-scale Architecture & Decision Logic"
format:
  html:
    page-layout: full
---

::: {.column-screen-inset}
::: {#workflow-diagram style="text-align: center; overflow: visible;"}
```{dot}
//| fig-width: 100%
//| fig-format: svg
digraph G {
    graph [
        rankdir=TB,
        nodesep=0.5,
        ranksep=0.8,
        splines=curved,      // ä½¿ç”¨åœ“æ»‘æ›²ç·š
        pad=0.3,
        bgcolor="transparent",
        center=true,
        newrank=true
    ]
    
    fontname="Arial"
    fontsize=24
    label="Autonomous Software Factory: Architecture Roadmap"
    labelloc="t"

    node [
        fontname="Arial", 
        shape=box, 
        style="filled,rounded", 
        fillcolor="#f9f9f9", 
        color="#333333",
        fontsize=12,
        width=2.5,
        height=0.8,
        margin=0.1
    ]
    
    edge [
        fontname="Arial", 
        color="#666666",
        fontsize=10,
        penwidth=1.2
    ]

    // --- åš´æ ¼çš„ç›¸ä½å®šä½ (ç”±å·¦è‡³å³) ---
    // å»ºç«‹ 4 å€‹ä¸å¯è¦‹çš„å®šä½é»ç¯€é»ï¼Œå¼·åˆ¶å®ƒå€‘åœ¨åŒä¸€æ°´å¹³æ’é–‹
    { rank=same; Phase1_Mark; Phase2_Mark; Phase3_Mark; Phase4_Mark }
    Phase1_Mark [shape=none, width=0, height=0, label="", style=invis]
    Phase2_Mark [shape=none, width=0, height=0, label="", style=invis]
    Phase3_Mark [shape=none, width=0, height=0, label="", style=invis]
    Phase4_Mark [shape=none, width=0, height=0, label="", style=invis]
    
    // å¼·åˆ¶å·¦è‡³å³é †åºä¸¦åŠ å¤§é–“è·
    Phase1_Mark -> Phase2_Mark [style=invis, minlen=4]
    Phase2_Mark -> Phase3_Mark [style=invis, minlen=4]
    Phase3_Mark -> Phase4_Mark [style=invis, minlen=4]

    // --- Phase 1: Discovery (å·¦æ¬„) ---
    subgraph cluster_0 {
        label = "Phase 1: Discovery";
        color = "#e8f5e9";
        style = "filled,dashed";
        fillcolor = "#f1f8e9";
        
        node [group=g1]
        { rank=same; Phase1_Mark; Human }
        Human [shape=circle, label="ğŸ‘©â€ğŸ’» Human", fillcolor="#e1f5fe", width=1.0, height=1.0]
        Orch [label="ğŸ Factory Orchestrator", fillcolor="#fff9c4"]
        ReqA [label="ğŸ“ Requirements Analyst"]
        D_UI [shape=diamond, label="Needs UI?", fillcolor="#ffffff"]
        VisD [label="ğŸ¨ Visual Designer", style="filled,dashed,rounded", fillcolor="#ffffff"]
        
        Human -> Orch -> ReqA -> D_UI
        D_UI -> VisD [label="Yes"]
    }

    // --- Phase 2: Tech Design (ä¸­å·¦æ¬„) ---
    subgraph cluster_1 {
        label = "Phase 2: Tech Design";
        color = "#fff3e0";
        style = "filled,dashed";
        fillcolor = "#fff8e1";
        
        node [group=g2]
        { rank=same; Phase2_Mark; Arch }
        Arch [label="ğŸ›ï¸ Architect Reviewer"]
        Sim  [label="ğŸ§  Mental Simulation", shape=ellipse, fillcolor="#ffffff"]
        
        Arch -> Sim
    }

    // --- Phase 3: Execution (ä¸­å³æ¬„) ---
    subgraph cluster_2 {
        label = "Phase 3: Execution";
        color = "#f3e5f5";
        style = "filled,dashed";
        fillcolor = "#f3e5f5";
        
        node [group=g3]
        { rank=same; Phase3_Mark; Iter }
        Iter [label="ğŸ­ Factory Iterator"]
        Track [label="ğŸ—„ï¸ tracker.json", shape=note, fillcolor="#ffffff"]
        Work [label="ğŸ‘· Worker Agents"]
        
        Iter -> Track -> Work
    }

    // --- Phase 4: Validation (å³æ¬„) ---
    subgraph cluster_3 {
        label = "Phase 4: Validation";
        color = "#ffebee";
        style = "filled,dashed";
        fillcolor = "#fffde7";

        node [group=g4]
        { rank=same; Phase4_Mark; CI_Gate }
        CI_Gate [label="ğŸ¤– CI Checker", shape=diamond, fillcolor="#ffffff"]
        Rep     [label="ğŸ©¹ Self-Healing", fillcolor="#ffccbc"]
        Merg    [label="âœ… Merge & Advance", fillcolor="#c8e6c9"]
        
        CI_Gate -> Merg [label="Pass"]
        CI_Gate -> Rep [label="Fail"]
    }

    // --- è·¨ Phase é€£æ¥é‚è¼¯ (ç”±å·¦è‡³å³æ¨é€²) ---
    edge [constraint=false]
    D_UI -> Arch [label="No"]
    VisD -> Arch
    Sim -> Iter
    Work -> CI_Gate [label="PR Submitted"]
    
    // å›é¥‹è¿´è·¯ (æ›²ç·š)
    Rep -> Work [color="#e57373", tailport=w, headport=w]
}
```
:::

[â¬…ï¸ è¿”å›å·¥ä½œæµèªªæ˜](FACTORY_WORKFLOW.qmd)