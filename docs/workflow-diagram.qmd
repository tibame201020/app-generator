---
title: "ğŸ”„ Factory Workflow Diagram"
subtitle: "Full-scale Architecture & Decision Logic"
format:
  html:
    page-layout: full
---

::: {.column-screen-inset}
::: {#workflow-diagram style="text-align: center; overflow: visible;"}
```{dot}
//| fig-width: 100%
//| fig-format: svg
digraph G {
    graph [
        rankdir=TB,
        nodesep=0.5,
        ranksep=0.6,         // å‚ç›´é–“è·
        splines=polyline,
        pad=0.2,
        bgcolor="transparent",
        center=true,
        newrank=true
    ]
    
    fontname="Arial"
    fontsize=24
    label="Autonomous Software Factory: Architecture Roadmap"
    labelloc="t"

    node [
        fontname="Arial", 
        shape=box, 
        style="filled,rounded", 
        fillcolor="#f9f9f9", 
        color="#333333",
        fontsize=12,
        width=2.5,
        height=0.7,
        margin=0.1
    ]
    
    edge [
        fontname="Arial", 
        color="#666666",
        fontsize=10,
        penwidth=1.2
    ]

    // --- å®šç¾© Phase ä¸»è»¸ (å»ºç«‹ç©©å®šçš„æ©«å‘é–“éš”) ---
    // ä½¿ç”¨ä¸€çµ„åŒ Rank çš„ä¸»å°ç¯€é»ï¼Œä¸¦çµ¦äºˆç›¸åŒçš„ minlen èˆ‡ weight
    { rank=same; Orch; Arch; Iter; CI_Gate }

    // å¼·åˆ¶æ©«å‘ä¸»è»¸ï¼Œminlen=3 ç¢ºä¿é–“è·ï¼Œweight ç¢ºä¿ç›´ç·š
    Orch -> Arch [style=invis, minlen=3, weight=100]
    Arch -> Iter [style=invis, minlen=3, weight=100]
    Iter -> CI_Gate [style=invis, minlen=3, weight=100]

    // --- Phase 1: Discovery (Group A) ---
    subgraph cluster_0 {
        label = "Phase 1: Discovery";
        color = "#e8f5e9";
        style = "filled,dashed";
        fillcolor = "#f1f8e9";
        
        // ä½¿ç”¨ group å±¬æ€§å¼·è¿«å‚ç›´ç¯€é»å°é½Šæˆç›´ç·š
        node [group=g1]
        Orch [label="ğŸ Factory Orchestrator", fillcolor="#fff9c4"]
        ReqA [label="ğŸ“ Requirements Analyst"]
        D_UI [shape=diamond, label="Needs UI?", fillcolor="#ffffff"]
        VisD [label="ğŸ¨ Visual Designer", style="filled,dashed,rounded", fillcolor="#ffffff"]
        
        Human [shape=circle, label="ğŸ‘©â€ğŸ’» Human", fillcolor="#e1f5fe", width=1.0, height=1.0]
        Human -> Orch -> ReqA -> D_UI
        D_UI -> VisD [label="Yes"]
    }

    // --- Phase 2: Tech Design (Group B) ---
    subgraph cluster_1 {
        label = "Phase 2: Tech Design";
        color = "#fff3e0";
        style = "filled,dashed";
        fillcolor = "#fff8e1";
        
        node [group=g2]
        Arch [label="ğŸ›ï¸ Architect Reviewer"]
        Sim  [label="ğŸ§  Mental Simulation", shape=ellipse, fillcolor="#ffffff"]
        
        Arch -> Sim
    }

    // --- Phase 3: Execution (Group C) ---
    subgraph cluster_2 {
        label = "Phase 3: Execution";
        color = "#f3e5f5";
        style = "filled,dashed";
        fillcolor = "#f3e5f5";
        
        node [group=g3]
        Iter [label="ğŸ­ Factory Iterator"]
        Track [label="ğŸ—„ï¸ tracker.json", shape=note, fillcolor="#ffffff"]
        Work [label="ğŸ‘· Worker Agents"]
        
        Iter -> Track -> Work
    }

    // --- Phase 4: Validation (Group D) ---
    subgraph cluster_3 {
        label = "Phase 4: Validation";
        color = "#ffebee";
        style = "filled,dashed";
        fillcolor = "#fffde7";

        node [group=g4]
        CI_Gate [label="ğŸ¤– CI Checker", shape=diamond, fillcolor="#ffffff"]
        Rep     [label="ğŸ©¹ Self-Healing", fillcolor="#ffccbc"]
        Merg    [label="âœ… Merge & Advance", fillcolor="#c8e6c9"]
        
        CI_Gate -> Merg [label="Pass"]
        CI_Gate -> Rep [label="Fail"]
    }

    // --- å¯¦è³ªè·¨ Phase é€£æ¥é‚è¼¯ (ä¸åƒèˆ‡éšå±¤è¨ˆç®—ä»¥é¿å…æ‹‰æ‰¯) ---
    edge [constraint=false]
    D_UI -> Arch [label="No"]
    VisD -> Arch
    Sim -> Iter
    Work -> CI_Gate [label="PR Submitted"]
    
    // å›é¥‹è¿´è·¯
    Rep -> Work [color="#e57373", tailport=w, headport=w]
}
```
:::

[â¬…ï¸ è¿”å›å·¥ä½œæµèªªæ˜](FACTORY_WORKFLOW.qmd)